# Mapbox Styleに関するあれこれ

[Mapbox Style Specification](https://docs.mapbox.com/mapbox-gl-js/style-spec/)に準拠して、地図デザインを行う際のTips、躓いた点、やりたいことなどのメモ

## 縦書き
text-writing-modeを利用すると、縦書きに対応できる。
* text-letter-spacingは縦書きにも効く。
* 長符「ー」が横書きのまま表示される。これは、mapbox-gl.js内の横書き用文字→縦書き用文字の変換リストにないため。試しに、`"ー":"｜",` を追加してテストしてみたらうまくいった。
* データドリブンな表現はできないので、データの属性値に応じて、縦横の指定を行うのはできない。その代わり、縦書きか横書きかの優先度を指定する。
* text-variable-anchor等と合わせて、なるべく多くの注記を表示するという運用を想定しているのかもしれない。

## ポリゴンの外周線
ポリゴンの外周線を自由度高く表示するには、ポリゴンとは別にラインとしてレイヤを設定するのがベストなのかもしれない。
* ポリゴン（"type"に"fill"を指定）の外周線を表示する場合、"fill-outline-color"を利用するのが一般的のようだ。
  * しかし、"fill-outline-color"では、色の指定しかできないようだ。
  * そのため、線の太さや破線表現ができない。
* ベクトルタイルデータ自体がポリゴンであっても、スタイル上はライン（"type"は"line"を指定）として表示することはできる。
  * ポリゴンの外周線のみがラインとして表示されることになる。
* 実装方法としては、まず、外周線のラインを描画し、その上にポリゴンを描画する。
  * タイル境界等でラインが表示されてしまうが、ポリゴンを描画する（ポリゴンで塗りつぶす）ことで、隠すことができる。
  * 外周線は、ポリゴンからはみ出す形で描画されるので注意。（なお、"line-width"は最終的な希望の太さの2倍にする必要がある。）

## ラインに沿ってテキストを表示させる
文字や数字等のテキストをラインデータに沿って表示させる（"symbol-placement"を"line"に設定する）場合、"text-max-angle"を緩めに設定しておくほうが良い。

